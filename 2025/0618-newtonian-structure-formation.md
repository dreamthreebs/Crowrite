# 0618-structure formation

***

## ✅ 球对称塌缩模型在宇宙学中的作用总结

***

### 🧠 基本思想：

> 球对称塌缩模型描述了：**一个密度略高于平均值的球形区域，如何在宇宙膨胀背景中因自引力而塌缩形成结构。**

***

### 🔁 塌缩全过程：

1. **初始扰动（小密度涨落 δi≪1\delta\_i \ll 1）**
   * 随宇宙膨胀线性增长 δ∝a\delta \propto a
2. **非线性演化开始**
   * 球壳因引力变得“跑得比背景慢”
   * 到达最大半径 → **转向点**（turnaround，θ = π）
3. **引力塌缩**
   * 球体收缩到 r=0r = 0，数学上密度 → ∞（θ = 2π）
4. **物理实际中**
   * 不会收缩成点 → 实际会达到 **动能 + 势能平衡（virial 化）**
   * 最终形成一个稳定结构：星系、暗物质晕等

***

### 📐 关键定量结果：

| 物理量                                                 | 数值      | 意义                    |
| --------------------------------------------------- | ------- | --------------------- |
| **线性临界密度** δc\delta\_c                              | ≈ 1.686 | 结构“刚形成”时，线性理论预测的对比度   |
| **Virial 密度** ρvir/ρˉ\rho\_{\text{vir\}}/\bar{\rho} | ≈ 178   | 塌缩后结构的平均密度（比背景）       |
| **转向点时非线性密度**                                       | ≈ 4.55  | 达到最大半径时的真实密度增长        |
| **塌缩时间点**                                           | θ = 2π  | 球体数学上收缩到 r=0r = 0 的时刻 |

***

### 🎯 地位与应用：

| 用途                       | 说明                                       |
| ------------------------ | ---------------------------------------- |
| ⭐ **结构形成判断标准**           | 用 δc=1.686\delta\_c = 1.686 判定是否形成了 halo |
| ⭐ **Press–Schechter 理论** | 估算结构数量分布（质量函数）                           |
| ⭐ **N-body 模拟分析工具**      | 定义 halo、判断何时形成结构                         |
| ⭐ **非线性发展研究的起点**         | 从线性 → 非线性结构的“桥梁模型”                       |

***

### ✅ 总结一句话：

> 球对称塌缩模型是宇宙学中最基础、最重要的**非线性结构形成模型**，它用最简单的假设解释了：**为何初始的微小扰动最终能长成我们今天看到的星系与大尺度结构。**

***

好，我们现在从最基本的问题开始讲清楚：

***

## 🧠 你现在问的其实是：

> 什么是 σR\sigma\_R？它和结构形成有什么关系？Press–Schechter 是什么？为什么会用它？

下面我一步步解释。

***

### ✅ 一、我们想解决的问题：

在宇宙中——

* 到底**哪些地方会塌缩形成结构（星系团、暗物质晕等）？**
* 多大尺度的结构会出现？
* 每种质量的结构有多少？

***

### ✅ 二、我们怎么判断“这个地方会塌缩”？

我们需要一个判据，那就是：

> **“这个地方的密度扰动够大（超过某个临界值），就会塌缩”。**

数学表达就是：

δR>δc\delta\_R > \delta\_c

* δR\delta\_R：某个区域半径 RR 内的平均密度扰动（“光滑后”的密度）
* δc≈1.686\delta\_c \approx 1.686：球对称塌缩模型推出来的临界值

***

### 📐 三、那什么是 σR\sigma\_R？

我们无法预测宇宙中每一个点的 δR\delta\_R，因为它是个随机场。\
我们能做的是：

> 看**整个宇宙中 δR\delta\_R** 这个量的**方差**——也就是波动有多大：

σR2=⟨δR2⟩\sigma\_R^2 = \langle \delta\_R^2 \rangle

它告诉你：

* 在尺度 RR 的球体中，平均扰动典型值是多少
* 如果 σR≫δc\sigma\_R \gg \delta\_c，那大概率这些区域就塌缩了
* 如果 σR≪δc\sigma\_R \ll \delta\_c，塌缩区域很少

***

### 🧱 四、Press–Schechter 理论怎么做这件事？

它做了一个非常聪明的假设：

> 假设 δR\delta\_R 是**高斯分布**，我们就可以计算“超过 δc\delta\_c”的概率！

于是就有：

塌缩区域所占比例=∫δc∞12πσRexp⁡(−δ22σR2)dδ=12 erfc(δc2σR)\text{塌缩区域所占比例} = \int\_{\delta\_c}^\infty \frac{1}{\sqrt{2\pi} \sigma\_R} \exp\left( -\frac{\delta^2}{2\sigma\_R^2} \right) \mathrm{d} \delta = \frac{1}{2} \\, \text{erfc} \left( \frac{\delta\_c}{\sqrt{2}\sigma\_R} \right)

这就是宇宙中**质量 M∼R3M \sim R^3** 的结构形成的概率！

***

### 📊 五、换成质量函数怎么用？

我们可以从这个概率推出每单位体积中，质量在 M∼M+dMM \sim M+\mathrm{d}M 的结构数量：

这就得到了**Press–Schechter质量函数**：

n(M) dM=ρˉM f(σM) ∣dln⁡σMdM∣ dMn(M) \\, \mathrm{d}M = \frac{\bar{\rho\}}{M} \\, f(\sigma\_M) \\, \left| \frac{\mathrm{d}\ln \sigma\_M}{\mathrm{d}M} \right| \\, \mathrm{d}M

其中：

* ρˉ\bar{\rho}：宇宙平均密度
* σM\sigma\_M：对应质量 MM 的扰动方差（从功率谱计算）
* f(σ)∝δcσexp⁡(−δc22σ2)f(\sigma) \propto \frac{\delta\_c}{\sigma} \exp\left( -\frac{\delta\_c^2}{2\sigma^2} \right)

这就是**预测结构形成数量**的关键公式！

***

### 📌 总结这套逻辑：

```plaintext
暴涨 → 初始扰动功率谱 P(k)
         ↓
  计算 σ(M) = 各质量尺度上的扰动强度
         ↓
  假设高斯分布 + δ_c 临界塌缩判据
         ↓
  得到每种质量的结构形成概率
         ↓
  → 得到 halo 质量函数 n(M)
```

这就完成了从**初始涨落** → **非线性结构形成概率**的**连接桥梁**。

***

### 云中云问题：

***

### ✅ 是的：**Press–Schechter（PS）理论在原始形式中确实遗漏了一部分物理**，**必须修正**。

下面我给你讲清楚**遗漏了什么**、**为什么会出错**、**怎么修正**。

***

### 🧱 问题出在哪？

#### ❗原始 PS 只考虑了“密度超过 δc\delta\_c”的区域

但它忽略了：

> **小尺度上密度超过 δc\delta\_c** 的区域，可能处在**大尺度上密度没超过的地方**。

这种“结构嵌在更大结构里”的情况，叫做：

> **云中云问题（Cloud-in-cloud problem）**

***

### 📉 后果是什么？

#### 原始 PS 模型只计算了：

P\[δM>δc]=12 erfc(δc2σM)\mathbb{P}\[\delta\_M > \delta\_c] = \frac{1}{2} \\, \text{erfc}\left( \frac{\delta\_c}{\sqrt{2} \sigma\_M} \right)

这是总概率的一半，**只算到了“第一次穿越”的一部分路径**，**漏了一半的结构**。

***

### 🧪 所以 Press 和 Schechter 做了一个“临时补丁”：

> **直接乘 2**

真实结构数量≈2×积分结果\text{真实结构数量} \approx 2 \times \text{积分结果}

你会在 PS 文献中看到这个因子 22，就是修正“云中云”问题的手动做法。

虽然这方法不优雅，但它能让质量守恒，并拟合观测数据。

***

### 🧠 更现代的处理方法：Excursion Set Theory（穿越集理论）

#### 核心思路：

* 把不同尺度上的 δR\delta\_R 看作**随机游走过程**
* 让塌缩判据 δc\delta\_c 变成一个“吸收壁”
* 只记录**第一次穿越 δc\delta\_c** 的尺度（避免重复计数）
* 数学上解决了“云中云”的统计错误

这就是 **Bond et al. (1991)** 提出的穿越集理论。

***

### 🧬 后续改进模型（Sheth–Tormen 等）：

* 考虑非球对称塌缩（ellipsoidal collapse）
* 修改 f(ν)f(\nu) 函数形状
* 拟合 N-body 模拟结果，更准确预测 halo 数量

***

### ✅ 总结一句话：

> **原始 PS 理论没考虑“云中云”的结构嵌套问题，导致低估结构数量，必须修正**。现代理论用随机游走（Excursion Set）等方法解决这个问题，得到更准确的质量函数。

下面是**从 Press–Schechter (PS) 理论 到 Sheth–Tormen (ST) 修正模型**的总结说明

***

### 🧩 从 Press–Schechter 到 Sheth–Tormen 的结构形成模型总结

***

#### 🧠 背景目标

Press–Schechter 理论用于预测宇宙中质量为 MM 的暗物质 halo 的数密度 dndM\frac{dn}{dM}，建立初始密度扰动与非线性结构形成的联系。

***

#### ✅ Press–Schechter 理论要点

1.  假设光滑密度场 δM\delta\_M 是高斯分布：

    P\[δM]=12πσMexp⁡(−δM22σM2)\mathbb{P}\[\delta\_M] = \frac{1}{\sqrt{2\pi}\sigma\_M} \exp\left( -\frac{\delta\_M^2}{2\sigma\_M^2} \right)
2. 假设若 δM>δc\delta\_M > \delta\_c（临界密度，球对称塌缩模型得出 δc≈1.686\delta\_c \approx 1.686），区域将塌缩形成 halo。
3.  得到塌缩概率：

    P\[δM>δc]=12 erfc(δc2σM)\mathbb{P}\[\delta\_M > \delta\_c] = \frac{1}{2} \\, \text{erfc}\left( \frac{\delta\_c}{\sqrt{2}\sigma\_M} \right)
4.  引入无量纲变量 ν=δc/σ(M)\nu = \delta\_c / \sigma(M)，定义 halo multiplicity function：

    fPS(ν)=2πνe−ν2/2f\_{\text{PS\}}(\nu) = \sqrt{\frac{2}{\pi\}} \nu e^{-\nu^2/2}
5.  得到质量函数：

    dndM=ρˉM2fPS(ν)∣dln⁡σdln⁡M∣\frac{dn}{dM} = \frac{\bar{\rho\}}{M^2} f\_{\text{PS\}}(\nu) \left| \frac{d\ln \sigma}{d\ln M} \right|

***

#### ⚠ PS 理论的问题

* 假设结构塌缩为完美球对称，不符合实际（真实 halo 是椭球形，受剪切扰动）
* 在高质量端（大 ν\nu）**低估结构数量**，在低质量端也不够准确
* 没有考虑环境依赖（如 tidal shear）

***

#### ✅ Sheth–Tormen 模型的修正

Sheth & Tormen (1999) 基于椭球塌缩模型，提出经验拟合的修正 multiplicity function：

fST(ν)=A2aπ\[1+(aν2)−p]νexp⁡(−aν22)f\_{\text{ST\}}(\nu) = A \sqrt{\frac{2a}{\pi\}} \left\[1 + (a\nu^2)^{-p} \right] \nu \exp\left( -\frac{a\nu^2}{2} \right)

* A≈0.322A \approx 0.322（归一化系数）
* a=0.75a = 0.75：控制指数衰减速度
* p=0.3p = 0.3：控制低质量增强幅度

***

#### ✅ ST 模型的优势

* 在**高质量端**抑制更慢，拟合 N-body 模拟更好
* 在**低质量端**数量上升幅度更合理
* 可导出更加精确的 halo bias 公式

***

#### 📌 总结对比（PS vs ST）

| 项目            | Press–Schechter (PS)             | Sheth–Tormen (ST) |
| ------------- | -------------------------------- | ----------------- |
| 塌缩模型          | 球对称                              | 椭球（经验修正）          |
| mass function | ∝νe−ν2/2\propto \nu e^{-\nu^2/2} | 修正项 + 指数更慢衰减      |
| 参数自由度         | 无                                | A,a,pA, a, p：拟合得到 |
| 精度            | 粗略估计                             | 精确拟合 N-body 模拟    |
| bias 预测       | 有偏差                              | 精确 bias 模型可导出     |
