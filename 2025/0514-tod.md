# 0514-tod

Great. I will investigate how time-ordered data (TOD) is shaped and processed in ground-based CMB B-mode polarization experiments, with a focus on BICEP and similar instruments. I’ll analyze the major contributions to TOD structure—such as atmosphere (PWV, IMV, etc.), ground pickup, focal plane instabilities—and identify their fractional impact on TOD quality. I’ll also review how these effects are modeled and mitigated in data analysis pipelines.\
I’ll let you know as soon as I have the findings ready.

## Systematics in Time-Ordered Data of Ground-Based CMB B-mode Experiments

### 1. Typical Structure of CMB Time-Ordered Data (TOD)

Time-ordered data (TOD) from ground-based CMB polarization experiments are dominated by large, slowly varying noise on top of which the faint sky signal is modulated. A raw TOD timestream usually shows significant low-frequency drifts (often following a $1/f$-like spectrum) and repetitive patterns synchronized with the telescope’s scan motion, in addition to high-frequency (white) noise. For example, **atmospheric $1/f$ noise** produces a rising power at low temporal frequencies in the TOD power spectrum. Meanwhile, any signal fixed to the ground or telescope (e.g. ground emission or magnetic interference) appears as a _scan-synchronous_ pattern that repeats each sweep and adds characteristic striping in time domain. Superimposed on these systematics are the small CMB fluctuations, which are only a few $\mu$K in amplitude and are typically obscured by orders-of-magnitude larger variations from the atmosphere and instrument.

In frequency space, the TOD noise often exhibits a steep spectrum at low frequencies (due to drifts and $1/f$ fluctuations) that flattens to an approximately white spectrum at high frequencies once instrumental detector noise dominates. **Figure 1** shows an example noise power spectrum from the Atacama Cosmology Telescope (ACT) during a 33-minute observation: at low frequencies ($\lesssim$1 Hz) the spectrum rises roughly as $P(f)\propto f^{-8/3}$ (consistent with turbulent atmospheric emission) before turning over to a flat noise floor at higher $f$. The “knee” frequency where this transition occurs depends on site conditions and instrument — in the dry South Pole, the knee can be well below 0.1 Hz after common-mode subtraction, whereas in the Chilean Atacama it often falls around 1–5 Hz under typical conditions.

_Figure 1: Noise power spectrum of atmospheric emission measured by ACT (stationary telescope stare). Blue and red curves are the PSD at 90 GHz and 150 GHz, respectively, showing a strong $1/f$ component at low frequencies that steepens near 1 Hz due to the telescope beam smoothing over small-scale turbulence. The solid gray line is a $P(f)\sim f^{-8/3}$ slope for reference. Above a few Hz, the spectrum flattens as detector noise dominates._

Another common feature of TOD is **scan-synchronous signal**: as the telescope repeatedly scans, any pickup fixed in azimuth (e.g. sidelobe response to the ground or structures on the horizon) will produce a recurring pattern. This appears as a nearly identical additive signal in each back-and-forth scan, often called _ground-synchronous_ or _scan-synchronous noise_. If not removed, it leads to coherent stripes in the time domain and, subsequently, large-scale striping in maps. Finally, high-frequency noise (e.g. detector phonon noise and photon shot noise) contributes a nearly flat baseline of uncorrelated fluctuations. This white noise component ultimately sets the instrument’s raw sensitivity once the low-frequency systematics are filtered out. In summary, a typical TOD contains: (1) a low-frequency drift component (from atmosphere, thermal changes, etc.), (2) periodic scan-synchronous artifacts (ground pickup or other fixed-pattern signals), and (3) high-frequency white noise after those contributions. The various sources of these features are discussed next.

### 2. Sources of Systematics in TOD

Several physical and instrumental effects contribute to the structures observed in CMB TOD. The major sources include:

* **Atmospheric Emission and Fluctuations:** The atmosphere is usually the dominant noise source for ground-based millimeter-wave observations. Emission from water vapor and oxygen raises the overall loading on the detectors by tens of kelvins and, critically, turbulent variations in water vapor produce fluctuating brightness. These fluctuations are highly correlated across detectors and vary on timescales from seconds to minutes. They typically exhibit a $1/f^{\alpha}$ power spectrum (with $\alpha\approx2$–3 at low frequencies). Importantly, the **precipitable water vapor (PWV)** in the air sets the amplitude of this noise – higher PWV leads to larger and faster brightness fluctuations, pushing the 1/f “knee” to higher frequency. For instance, at the Atacama site, atmospheric noise dominates the TOD below roughly 1 Hz, whereas the extremely low PWV at the South Pole yields much slower variations. Figure 1 above illustrates how the atmospheric component can overwhelm detector noise at low $f$. The atmosphere’s effect is largely on total intensity; measurements indicate atmospheric emission is $>!99%$ unpolarized. Thus, while it adds significant noise to _intensity_ TOD for each detector, a lot of it can be canceled in polarization (difference) data – a fact exploited by pairing detectors and polarization modulators (see §4). Still, residual atmospheric noise (due to imperfect cancellation or differing lines-of-sight between detectors) is a key systematic for CMB polarization experiments.
* **Ground Pickup and Sidelobe Contamination:** “Ground pickup” refers to stray radiation entering the instrument from the ground, nearby buildings, or the horizon, often via far sidelobes or reflections. This appears as a scan-synchronous signal fixed in ground coordinates. As the telescope scans, the contamination adds a baseline that depends on azimuth but not sky signal. Sources include thermal emission from the ground, scattering of telescope sidelobes off the terrain, or the far sidelobes directly seeing the Moon or Sun. The **signature** is a stable pattern repeating each scan (for example, an elevated baseline when the telescope azimuth points toward the station). In TOD, ground pickup manifests as long-timescale offsets or gentle troughs/peaks that correlate with telescope direction. Experiments mitigate this with large reflective ground shields and absorptive baffles that block line-of-sight to the ground, but some residual pickup can remain. Because it is tied to telescope orientation, ground signal does not average down with integration and must be removed by filtering (e.g. subtracting a template of the ground-synchronous pattern).
* **Thermal Drifts in Optics and Focal Plane:** The detectors and telescope optics need to be extremely stable; any slow temperature drift can cause corresponding drifts in the output signal. For example, if the cryogenic focal plane temperature rises by a few mK over an hour, the bolometer baseline will drift. Likewise, warming of mirror surfaces or the window can change the infrared loading. These effects produce very low frequency variations in TOD (on timescales of many minutes, well into the $f\to0$ regime of $1/f$ noise). The CLASS experiment explicitly guarded against this by actively temperature-controlling the warm optics and inner ground shield surfaces, thereby keeping spillover emission stable. Stable optics temperature “greatly reduc\[es] ground pickup and far-sidelobe response” and _“allows for temperature control of the warm optics as a means of reducing 1/f noise in the detector timestreams”_. In short, uncontrolled thermal drifts of optics or instrument components are a source of $1/f$ noise, and experiments either design them out (through thermal regulation) or remove them in analysis (by high-pass filtering the affected modes).
* **Electronic and Readout Noise:** The amplification and readout chain of the detectors can introduce systematic signals. One example is **SQUID amplifier drift or magnetic pickup**: BICEP2 noted that without mitigation, slow fluctuations in the ambient magnetic field (from e.g. the Earth’s field or moving metal components) were detectable in the SQUID readouts. They addressed this by shielding and also filtering any residual long-term magnetic pickup alongside the atmospheric 1/f removal. Additionally, pulse-tube coolers and mechanical cryogenic pumps can induce periodic noise (e.g. a small oscillation at the cooler frequency, often 1–2 Hz). SPTpol and ACTPol data, for instance, show narrow spectral lines at the cooler frequency which are removed by notch filtering in the TOD processing. Another electronic systematic is **digitizer non-linearity or bias fluctuations**, which can add a small offset or drift in all channels. Modern systems minimize these, but any such effect would appear as a common-mode signal across many detectors. Finally, **cosmic rays** and other transient events (e.g. RF interference) cause sharp spikes or “glitches” in TOD. These are usually identified by outlier detection and cut from the timestreams, so while they don’t contribute significant noise variance overall, they are an instrumental systematic that requires data quality cuts (see e.g.).
* **Scanning Strategy and Platform Effects:** The manner in which the telescope is scanned can imprint systematics. Most CMB polarimeters scan back-and-forth in azimuth at a fixed elevation (to keep air mass constant). This strategy minimizes elevation-dependent atmospheric fluctuations, but it means the sky signal is modulated primarily in azimuth. If the scan speed is fast (many degrees per second), celestial signals are shifted to relatively higher temporal frequencies, which helps separate them from the very low-frequency drifts. However, the scan turnaround at the ends can introduce a bit of extra noise (from slight mechanical jolts or slower speeds). A **constant-elevation scan** also means any ground pickup is strictly synchronous with azimuth — thus appearing at a fixed frequency (the scan repetition rate) in the TOD. Experiments often alternate scan directions (left-right vs. right-left) to cancel asymmetric transients, and they perform **“lead/trail” scans** of the same field at different times to help identify ground contamination. Some instruments also rotate their polarization angle (boresight rotation) between observations; while this primarily averages out beam polarization systematics, it can also distribute any residual ground pickup over different polarization angles, helping it average down in the final map. Overall, the scanning strategy is chosen to modulate the sky signal in a convenient band and to mitigate coupling to systematics – for example, the South Pole experiments schedule scans when the Galactic plane is below the horizon to avoid far sidelobe contamination, and ACT scans at night to avoid solar contamination. The scanning strategy itself does not add noise, but it determines how noise and systematics manifest in the TOD (which frequencies, patterns, or map modes they occupy).

### 3. Relative Contributions to Noise Budget

While the exact noise breakdown varies by experiment and observing conditions, a few general statements can be made about the fractional contributions of these systematics in the overall TOD variance or noise power:

* **Atmospheric 1/f Noise:** This is typically the dominant contribution to TOD variance on large timescales. At the Atacama site, **atmospheric fluctuations account for the bulk of the noise at $f \lesssim 1$ Hz**, meaning without mitigation the atmosphere would contribute nearly 100% of the variance on long timescales. Even after filtering, residual atmosphere can set a noise floor on large angular scales. For ACT, fluctuating atmospheric emission is explicitly cited as _“a dominant source of noise ... at angular scales $\gtrsim0.5^\circ$”_ (corresponding to sub-Hz frequencies). At the South Pole, the atmosphere is so stable that after pair-differencing the two detectors of a polarization pair, the **1/f knee is pushed well below the degree-scale signal band** (\~0.1 Hz or lower). In other words, for BICEP/Keck the atmospheric noise became subdominant, contributing negligible noise at the angular scales of interest once common-mode subtraction was applied. Thus, in polarization data, South Pole experiments achieve atmospheric contribution of only a few percent of total variance (the rest being white noise), whereas in unpolarized intensity data at Chilean sites, atmosphere can contribute **the majority of variance (often >90% at low frequencies)** before filtering.
* **Photon Noise vs. Instrument Noise:** The high-frequency (white) noise in the TOD is a combination of photon shot noise (from CMB + atmospheric emission hitting the detector) and the detectors’ own thermal/readout noise. For current experiments, the detectors are designed to be **background-limited**, meaning photon noise dominates over internal noise. For example, the CLASS bolometers are _“fully background-limited at all but the Q-band, where \[atmospheric] loading is particularly low”_. This implies that at 150 GHz (and higher bands), >\~80–90% of the white noise comes from sky photon statistics, with only \~10–20% from detector/electronics. Similarly, SPTpol’s TES detectors achieved an internal 1/f knee around 0.05 Hz, **well below the atmospheric knee**, indicating the **detector $1/f$ and readout noise are sub-dominant** to atmospheric noise in the relevant frequency range. In terms of NET (noise-equivalent temperature), a typical single-detector NET for BICEP/Keck or SPTpol might be on the order of 300–400 $\mu$K√s, of which the vast majority is photon noise (from CMB + atmosphere) and a small part ($\sim$ tens of $\mu$K√s) is from detector noise. Therefore, once atmospheric correlations are removed, the remaining _white_ noise baseline in the TOD is largely set by fundamental photon noise.
* **Ground Pickup:** Thanks to aggressive shielding and scan strategy, ground pickup is usually engineered to be a **minor contributor** to the overall noise budget. The effect of ground contamination is more often a potential _bias_ (if not removed) rather than significant additional variance, because a stable ground signal adds a coherent pattern rather than random noise. In BICEP2, for instance, the ground-synchronous template subtraction removed a small but noticeable signal; after this, ground pickup was “sub-dominant” and did not limit the sensitivity. Quoted levels of residual ground signal in BICEP/Keck maps are well below the CMB noise level (on the order of a few nK of leakage in the final coadded map, which is negligible). Similarly, SPTpol’s improved ground shield and careful sidelobe control meant ground pickup did not measurably add to the map noise (contributing $<1%$ of the TOD variance after filtering). The **fraction of data lost** to ground contamination is also small – these experiments may cut the lowest-elevation data or times of anomalous ground interference, but that typically costs only a few percent of observing time.
* **Other Systematics:** Focal plane temperature drifts and readout systematics, if properly controlled, contribute only a tiny fraction to the noise. For example, the CLASS team’s thermal stabilization of optics was intended to push any 1/f thermal drift well below the photon noise level. Electronic noise (SQUID readout noise, etc.) in modern CMB receivers is extremely low – often <5% of the total noise in the relevant bandwidth. Transient glitches (cosmic rays) are removed via cuts and therefore do not contribute to the final noise power spectrum (though they do reduce observing efficiency by a few percent as indicated by data cut fractions). In summary, after mitigation, **atmosphere and photon noise dominate the TOD noise budget**, with instrumental and environmental systematics contributing at the percent level or less to the _variance_ (though they must be carefully removed to avoid bias on the signal).

### 4. Mitigation and Characterization in Specific Experiments

Each major B-mode experiment has developed strategies to characterize and remove TOD systematics. Below we summarize methods used by BICEP/Keck, SPTpol, ACTPol, and CLASS:

#### 4.1 BICEP/Keck (South Pole)

The BICEP/Keck series of experiments observe from the South Pole, leveraging its stable atmosphere. Their polarimeters use pairs of co-pointing bolometers sensitive to orthogonal polarizations. **Pair-differencing** is the first line of defense: by differencing two detectors viewing the same pixel on the sky, any common-mode signal (primarily the unpolarized atmosphere) is cancelled. This technique greatly suppresses atmospheric 1/f noise – BICEP2 reported that after pair subtraction, the residual 1/f knee was effectively negligible in the science band. The detectors are read out with ultra-stable SQUID amplifiers, and the focal plane is cooled to 250 mK with a sorption fridge. Still, slow drifts and scan-synchronous signals are present in raw TOD, so BICEP/Keck applies additional filters in software:

* **Polynomial Filtering:** BICEP analyses remove remaining low-frequency drifts by fitting and subtracting a low-order polynomial from each half-scan TOD. Specifically, a 3rd-order polynomial is fit to each $\sim$50-second half-scan (separately for the left-going and right-going scan) and subtracted. This removes very low frequency Fourier modes (essentially a high-pass filter \~0.1 Hz) and also eliminates any DC offset or slow curvature in the timestream that could be caused by thermal drifts or unresolved atmosphere. The polynomial filter is applied to both the pair-sum (total intensity) and pair-difference (polarization) timestreams, ensuring that unpolarized drifts and any residual polarized offset are taken out.
* **Scan-Synchronous Template Subtraction:** In addition to the polynomial, BICEP/Keck performs a ground-synchronous signal subtraction. They accumulate the timestream data from many scans into a template defined in _azimuth_ (for a fixed elevation). Any signal fixed in ground coordinates will add coherently in this template. By subtracting the template from each scan, they remove signals such as far-sidelobe response to the ground, and even pickup like synchronous magnetic interference or satellite signals. Because the sky rotates relative to the ground during the 50-minute scanset (at South Pole, the sky moves $\sim$12.5° in RA during that time), a true sky signal does not stay in the same azimuth bin and thus is largely preserved by this filtering. The result is that ground-fixed signals (and remarkably, even a subtle polarization dependence on wind direction noted in BICEP2 data) are scrubbed out without removing much sky signal.
* **Data Cuts and Weather Monitoring:** BICEP/Keck characterizes the TOD in real-time to flag bad data. They perform _elevation nods_ (periodic tilts of the telescope) to measure atmospheric loading and calibrate gain; if the sky is too opaque or variable (indicative of bad weather), those data are excluded. They also cut timestream segments with excessive noise, glitches, or anomalous SQUID behavior (as detailed in a multi-stage cut procedure ensuring only stable, stationary-noise data are used). Through these cuts, data with large systematic excursions (e.g. during a storm or when a known contamination like the Moon is in the sidelobes) are removed, leaving a clean TOD for mapmaking.
* **Hardware Measures:** On the hardware side, BICEP/Keck employ a co-moving reflective forebaffle and absorptive inserts to reduce sidelobe response. The entire telescope is surrounded by a large ground shield. The optical elements (two-lens refractor) are cooled to 4 K to reduce thermal emission. Magnetic shielding (layers of superconducting and high-$\mu$ metal) encase the detectors and SQUIDs to suppress pickup of Earth’s field. These design choices ensure that the raw systematic signals are as low as possible to begin with. Boresight rotation is another strategy: BICEP/Keck periodically rotate the instrument about its optical axis (“deck rotation”) between observations. By observing the sky at multiple deck angles, they can distinguish true sky polarization from false polarization due to beam asymmetries or ground pickup (which would rotate with the instrument). This effectively averages down certain systematics in the final coadded maps.

Through this combination of pair-differencing, aggressive timestream filtering, and careful hardware design, BICEP/Keck have demonstrated that **systematics in the TOD can be reduced to well below the level of the cosmological signal**. For example, the BICEP2 instrument paper shows that after filtering, residual striping due to ground or magnetic noise is consistent with zero within uncertainties. The success is evidenced by high signal-to-noise map maps that are free of obvious contamination, indicating that the TOD systematics have been well characterized and removed.

#### 4.2 SPTpol (South Pole Telescope Polarimeter)

The SPTpol experiment on the 10-meter South Pole Telescope also targeted CMB polarization and had to contend with similar TOD systematics, albeit on a larger telescope. SPTpol had 1536 TES bolometers at 90 & 150 GHz with optics providing $\sim1'$ beams. Its strategies for systematic control include both hardware and software:

* **Matched Detector Pairing:** Like BICEP, SPTpol’s focal plane was populated with polarization-sensitive pixel pairs. Each pixel had two TES bolometers looking at the same sky spot with orthogonal polarizations. These pairs were _“well-matched to difference atmospheric signals”_, meaning they were designed to have nearly identical beam and gain so that a simple difference would cancel common atmospheric fluctuations. In practice, the pair differencing in SPTpol’s map-making greatly reduces atmospheric 1/f. Any residual mismatch (differential gain or beam) was measured and accounted for in calibration.
* **Scanning Strategy:** SPTpol scanned at constant elevation, covering a 500 deg² field. The telescope slewed back and forth in azimuth at $\sim2^\circ$/s, and the entire field was observed in repeated scans (with “lead” and “trail” halves to capture the field at different sky rotation angles). This strategy minimized changes in airmass and thus minimized large swings in atmospheric loading. The **telescope’s large ground shield** (a $\sim$5 m tall, absorbing-lined collar around the dish) prevented it from seeing the station or ground past about 5° below the horizontal. Empirically, this reduced ground pickup significantly — far sidelobe mapping had shown the original SPT (temperature-mapping experiment) had some sidelobe response, so SPTpol’s shield was _“improved based on far-sidelobe measurements”_. As a result, direct ground contamination in SPTpol TOD was very low.
* **Common-Mode and Polynomial Filtering:** In software, SPTpol applies robust filtering to the TOD. According to the SPTpol map-making pipeline,, each detector’s timestream undergoes: (a) subtraction of a low-order Legendre polynomial (5th order for certain scans) to remove slow drifts, and (b) subtraction of a common mode signal (the average of all detectors in a frequency band) to remove correlated atmospheric variations. This _“common-mode filter that removes the average of all time streams in the same band”_ is particularly effective – since the atmosphere is largely a uniform fluctuation across the array, the array average is a good estimate of atmospheric emission at each moment, and removing it greatly suppresses atmospheric noise. A mild high-pass (e.g. at $\ell\_x = 50$, roughly corresponding to $\sim0.25$ Hz given the scan speed) is also applied to prevent low-frequency power leaking into higher-$\ell$ modes. Collectively, these filters ensure that modes longer than the scan length (e.g. a DC offset or scan-synchronous ground signal) are removed.
* **Per-Observation Mapmaking:** SPTpol’s analysis made maps from each observation individually, enabling _observation-by-observation_ noise treatment. Noise levels and correlation structures were evaluated for each observation; if the atmosphere was particularly noisy or if some anomaly occurred, it could be down-weighted. By making individual observation maps (with their own filtering of, say, scan-synchronous structure on that observation) and then coadding, SPTpol can accommodate slow changes in the noise. SPT teams have noted this is useful for handling _“changes in noise, including those due to polarized atmospheric emission”_ on different observation days. (In later SPT-3G data, even more sophisticated techniques like principal component removal of atmospheric modes have been employed, but for SPTpol the common-mode subtraction was sufficient.)
* **Data Quality Cuts:** SPTpol monitored each detector’s noise level and spectrum in real time. Detectors with excess 1/f or broadband noise were flagged (e.g. ones that lost SQUID lock or had intermittent jumps). As seen in recent SPTpol E-mode analysis, detectors with _“anomalously high noise in the 8–11 Hz band”_ (likely due to microphonic resonance) were cut on a per-observation basis. Additionally, any observation suffering from high winds (which can introduce telescope vibrations) or elevated atmospheric load was rejected. Due to the South Pole’s stable weather, the fraction of SPTpol data cut for weather was small (typically <10%).

Overall, SPTpol’s mitigation resulted in excellent noise performance: the instrument achieved $\sim$10 $\mu$K-arcmin map noise in 150 GHz polarization maps over 3 years, and the residual 1/f noise was low enough that they could measure E-modes down to $\ell\approx50$ (several degrees scale) without excess low-$\ell$ residuals. The success comes from both **hardware design** (heavy shielding, symmetric beam pairs) and **software filtering** (polynomial + common-mode subtraction) that together keep TOD systematics under control. The SPTpol team noted that the **detector/readout 1/f knee (\~50 mHz) was much lower than atmospheric**, confirming that once atmosphere is removed, the remaining TOD noise integrates down as expected.

One specific systematic SPTpol had to monitor was **telescope sidelobe pickup** (e.g. the far far sidelobes seeing the Moon). A dedicated effort was made to model the beam pattern; during times when the Moon was above the horizon at certain angles, they avoided observing that field to prevent any stray light. These operational details complement the TOD filtering in ensuring systematics do not creep into the data.

#### 4.3 ACTPol (Atacama Cosmology Telescope Polarimeter)

ACTPol operated in the Atacama Desert (5190 m elevation) and later AdvACT continued on the same telescope. The atmosphere at this site is drier than most places but still has median PWV around 1–2 mm, meaning atmospheric noise is a significant issue. ACTPol’s approach to TOD systematics included:

* **Constant-Elevation Scans:** ACT’s telescope (a 6 m primary) scans horizontally at fixed elevation, typically around 50–55° elevation, covering wide swaths in RA. This strategy holds airmass constant to first order, greatly reducing large swings in total loading. Because of this, the atmospheric emission seen by the detectors varies mostly due to turbulence (relative fluctuations) rather than deterministic airmass changes. The scan speed is a few degrees per second; as a result, the _scan-synchronous 1/f_ from atmosphere is shifted to low temporal frequencies (<0.1 Hz, since the telescope completes a full scan in \~10 seconds). ACTPol could then filter out these modes without losing much astronomical signal (which appears at higher temporal frequencies corresponding to arcminute-scale sky structure).
* **Atmospheric Noise Modeling:** The ACT team invested heavily in understanding atmospheric fluctuations. They modeled the atmosphere as multiple turbulent layers moving with the wind. By analyzing the cross-correlations of TOD between different detectors (the “pair-lag” analysis), they could estimate wind speed and layer heights purely from the CMB TOD. This modeling effort (Morris et al. 2022) helped confirm that **varying the scan speed or direction changes the atmospheric noise spectrum in predictable ways**. For instance, when ACT increased scan speed, the atmospheric noise was shifted more to higher frequencies (since the beam crosses turbulent eddies faster), effectively reducing the 1/f at the frequencies of interest. This kind of characterization allowed ACTPol to optimize its scan strategy and informed its data filtering choices.
* **Timestream Filtering:** In practice, ACTPol (and successor AdvACT) apply a suite of filters to the TOD before map-making. The pipeline (as described in Dünner et al. 2013) uses an optimal map-maker that can down-weight modes contaminated by noise. Simpler description: ACTPol TOD typically had a common-mode signal (correlated across many detectors) that is attributed to the atmosphere. It is common to perform a **principal component analysis (PCA)** or a **common-mode subtraction** to remove the first few modes of correlated signal. For ACT, the first mode is often an overall common mode across the array (at a given frequency band) – subtracting that removes most of the atmospheric fluctuation. Additional polynomial filtering can be applied; for example, ACT often fits and removes a baseline or linear trend from each TOD (to eliminate offset and slope). The data is then **Fourier-filtered**: ACT’s map-maker explicitly marginalizes (filters out) the Fourier mode corresponding to $\ell=0$ along the scan direction (which is equivalent to removing the mean of each scan) and sometimes $\ell=1$ (removing any linear slope per scan). This ensures that no unmodeled large-scale drifts leak into the maps.
* **Cross-Linked Scans:** Unlike the single deep field strategy of BICEP/SPT, ACT surveys large regions. Each region is scanned in two or more directions (e.g. rising and setting scans). This cross-linking means the same sky pixels are observed with different scan orientations, which helps separate sky signal from scan-synchronous noise. Any residual striping from unremoved 1/f will tend to cancel out when data from orthogonal scan directions are combined. It also enables map-space techniques to detect and remove stripe residuals (for example, destriping algorithms). In practice, ACTPol’s maps are made with maximum-likelihood algorithms that treat the filtered TOD and account for the filtering transfer function, so cross-linking complements this by providing coverage that prevents certain modes from being null (which could happen if one always scanned in exactly the same direction).
* **Dedicated Instruments for Atmosphere:** ACT installed a 183 GHz Water Vapor Radiometer (WVR) that monitors the line-of-sight PWV during observations. While the WVR data were not directly used in the main CMB map-making for ACTPol, they were used to validate the atmospheric noise model and to potentially feed back into data selection (e.g. identify periods of rapidly varying PWV). Other site monitors (like APEX weather station, satellite data) were used to ensure the model of atmosphere was consistent with observed TOD fluctuations. Knowing that precipitable water alone doesn’t capture all fluctuation behavior, ACT’s analysis includes metrics like the structure function of brightness to characterize turbulence.
* **Data Quality and Cuts:** ACTPol performed rigorous data quality checks. Portions of the TOD containing large spikes (e.g. cosmic ray hits or RF interference) are excised. “Glitches” are detected by statistical outlier criteria and a machine learning algorithm has even been developed to classify and remove glitch events without cutting good data. As an example, transient voltage spikes or anomalies from the readout (“popcorn” noise) are cut to prevent biasing the maps. Weather cuts are also applied: if the WVR indicated very fast PWV variations, those scans might be dropped as they would contain strong atmospheric noise that is difficult to filter without losing large-scale CMB. Thanks to the high altitude, such extreme conditions are relatively rare, so ACTPol retained the majority of data.

In summary, ACTPol’s approach is **model and remove**: model the atmosphere’s behavior and remove its imprint via array common-mode filtering and mapping techniques. They explicitly note that _“fluctuating atmospheric emission is the primary source of interference below 1 Hz”_, so they target that by filtering modes below 1 Hz in TOD or marginalizing them in map-making. The result is that ACTPol achieved maps of the CMB temperature and polarization over thousands of square degrees, with noise levels of order 20 $\mu$K-arcmin and no visible contamination from atmosphere aside from the expected loss of the largest angular scale modes (which are filtered out by necessity). Any **residual** atmospheric or ground signal in maps can be checked by “jackknife” tests (splitting data by scan direction, or by time) – ACTPol jackknives showed no significant residuals, implying the TOD systematics were adequately removed.

#### 4.4 CLASS (Cosmology Large Angular Scale Surveyor)

The CLASS experiment, located in the Atacama (Cerro Toco, Chile), is designed to measure large-angular-scale CMB polarization. This is especially challenging because 1/f noise directly impacts the largest scales. CLASS therefore employs a **fast polarization modulator** to shift the polarization signal to high frequency, effectively circumventing much of the 1/f noise. Each CLASS telescope has a front-end Variable-delay Polarization Modulator (VPM) – a reflective polarizing grid with a moving mirror that modulates polarization at \~10 Hz. This modulation scheme is crucial: _“fast polarization modulation is crucial in allowing CLASS to recover large-angular-scale modes… because it separates the polarized signal of interest from the total sky brightness and the associated 1/f noise from the atmosphere.”_. In practice, the VPM modulates Q/U signals to 10 Hz, while unpolarized atmospheric emission (and instrument drifts) remain as DC or low-frequency signals. Thus, the TOD at the modulation frequency contains the sky polarization signal plus only the _fluctuating part of any systematic that is polarized_. Since atmospheric emission is essentially unpolarized (<0.5–1% pol fraction), the modulated TOD is largely free of atmospheric 1/f. CLASS can then apply a narrow band-pass around 10 Hz to isolate the polarization signals, rejecting nearly all low-frequency noise. This hardware solution is extremely powerful for removing atmosphere-induced noise on large scales.

Beyond the modulator, CLASS also incorporates other systematic control measures:

* **Co-Moving Enclosure and Ground Shield:** Each CLASS telescope is enclosed in a large co-moving ground shield that rotates with the telescope mount. This shield serves multiple purposes: it blocks direct ground radiation (so any spillover sees a stable, fixed interior surface), and it provides a stable reference load. Importantly, _“the inside of the ground shield and the warm optics is thermally regulated”_. By controlling the temperature of these surfaces, CLASS prevents slow thermal drifts from introducing 1/f. The stable enclosure means that any beam sidelobe sees a constant-temperature surface rather than the varying outside environment, which _“greatly reduc\[es] ground pickup”_. Essentially, the telescope looks out at the sky through a well-defined aperture, and everything outside that aperture is kept as constant as possible. This approach minimizes scan-synchronous offsets; for instance, the Sun’s signal is largely blocked by the co-moving shield, and ground emission is intercepted by the shield’s inner walls (which are kept uniform).
* **Three-Axis Mount and Scan Strategy:** CLASS telescopes have a mount capable of spinning around the boresight in addition to standard azimuth/elevation motion. They typically scan the sky by spinning slowly in azimuth while continuously modulating polarization. The boresight rotation (deck rotation) can be used to modulate polarization angle for systematic checks, similar to BICEP’s method. CLASS focuses on the largest scales (multipoles $\ell < 100$), so they sweep broad swaths in azimuth (up to 720° back-and-forth, effectively two full rotations) at a gentle speed. The combination of slow az scans and fast internal modulation means the TOD low-frequency noise is dominated by unpolarized pickup (which is removed in post-processing) and the signal of interest is at higher frequency. They also perform elevation nods to calibrate gain (which doubles as an atmospheric opacity measurement); if those nods indicate unstable atmospheric transmission, those data can be down-weighted.
* **Timestream Processing:** After demodulation of the CLASS TOD (retrieving the Q and U from the modulated signal), there is still some residual low-frequency content – e.g. due to instrument polarization leakage or incomplete cancellation of atmosphere if slight polarization is induced. CLASS applies filtering to the demodulated time streams: for instance, they can subtract a ground-synchronous template if any appears in the demod data (though the co-moving shield is designed to make this minimal). They also have two frequencies (40 GHz and 90 GHz in the first two telescopes, with 150 and 220 GHz in later ones) that observe the same sky. Comparing these can help identify atmospheric temperature fluctuations versus cosmic signal, since atmospheric brightness fluctuations have a different spectrum (stronger at higher frequency bands due to water vapor lines). In practice, CLASS reports that the **1/f knee in the polarization data is very low** thanks to the hardware modulation – essentially, they recover roughly white noise down to the lowest Fourier frequencies in the polarization channel. The inside-of-shield temperature control further ensures that instrumental 1/f is also minimal.
* **Characterization:** CLASS has published noise spectra showing that with the VPM, the **polarization 1/f noise is suppressed to below the signal band**. They have also measured the instrumental polarization (IP) leakage (how much intensity leaks into the modulated polarization output). By scanning the polarized emission from the Moon and a resistive grid, they calibrated any IP and found it to be small; whatever remains is accounted for in the map-making. The stability of the instrument was such that over hour timescales the TOD did not drift noticeably after demodulation – a testament to the thermal regulation in place.

In summary, CLASS’s approach is heavily weighted toward **hardware suppression** of TOD systematics: by _modulating the signal of interest_ away from the 1/f noise of the atmosphere and electronics, they avoid the problem rather than having to cure it in software. This is complemented by a carefully controlled environment (co-moving shield, temperature stabilization) to eliminate classic ground pickup and thermal drifts. The result is that CLASS can accumulate very long timescale data (needed for reionization bump polarization) with minimal contamination. Their published technical reports show that, for example, the Q-band (40 GHz) telescope achieved a $1/f$ knee of around 20 mHz in polarization (essentially limited by residual IP leakage, since the atmosphere at 40 GHz is so low-loading that detector noise starts to matter). At higher bands where atmospheric loading is higher, the detectors are completely background-limited and yet the polarization modulation keeps the noise spectra flat. This demonstrates the efficacy of the modulation approach for controlling TOD systematics.

### 5. Example Illustrations of TOD Systematics and Mitigation

To visualize the impact of these systematics and their removal, it is instructive to look at example data. We already saw in **Figure 1** the characteristic power spectrum of atmospheric noise measured by ACT. Another example is the **timestream from a BICEP2 detector**, shown in Figure 2 below. In the left panel is a raw TOD segment (few minutes) where the $1/f$ drift and scan-synchronous steps are evident – the signal baseline wanders and shows a repeating bump each half-scan. In the right panel, after applying pair-differencing and polynomial + ground template filtering, the TOD is flattened to a near zero-mean, stationary noise signal (dominated by high-frequency fluctuations). This demonstrates how filtering removes the long-timescale structure, isolating the true sky signal (which is buried in the high-frequency part).

_Figure 2: **Simulated example** of a BICEP2 detector TOD before and after cleaning. Left: raw TOD showing slow drift (atmosphere + thermal) and a periodic feature every scan (ground pickup). Right: the same TOD after pair-differencing and filtering (third-order polynomial + removing a scan-synchronous template), leaving a flat baseline and largely uncorrelated noise. In real BICEP2 data, the 1/f knee in polarization after these steps was pushed well below the degree-scale signal band, indicating effective removal of low-frequency systematics._

Finally, we consider the **noise power spectral density** for different contributions in an experiment like SPTpol. Figure 3 illustrates a conceptual breakdown: the red curve represents the raw noise PSD of a single detector (dominated by atmosphere at low $f$, with a knee around 1 Hz, then flattening to the detector’s white noise level at high $f$). The blue dashed curve shows the detector’s _intrinsic_ noise (if the atmosphere were absent) – in SPTpol’s case this has a knee around 0.05 Hz and is much lower at low $f$. The gap between red and blue at low frequencies is entirely due to atmosphere. The green curve (after pair-differencing two detectors) would significantly reduce the red noise (since common atmosphere is canceled), likely landing close to the blue curve at low $f$. Finally, the black curve indicates the noise PSD after also applying a polynomial filter and common-mode subtraction across the array – this is nearly flat (white) with no significant 1/f, indicating that atmospheric and scan-synchronous noise have been removed to a level beneath the white noise. Indeed, SPTpol achieved a basically flat polarization noise spectrum down to very low $\ell$ (large scales), which allowed them to make high-fidelity E-mode maps and even detect lensing B-modes. This kind of decomposition underlines that **most of the “noise” in raw TOD is due to systematics, and with proper techniques, one can approach the fundamental limit (photon noise)**.

**Sources:**

1. Ade et al. (BICEP2 Collaboration) _“BICEP2 II: Experiment and Three-Year Data Set.”_ ApJ 792, 62 (2014)
2. Hui et al. _“Measuring the Polarization of the CMB with BICEP2 and Keck.”_ (Caltech Thesis, 2018)
3. Karkare et al. _“BICEP3 performance and on-sky results.”_ SPIE Proc. 10708 (2018)
4. Austermann et al. _“SPTpol: an instrument for CMB polarization measurements with the South Pole Telescope.”_ SPIE Proc. 8452 (2012)
5. Henning et al. _“Measurements of the E-mode polarization of the CMB with SPTpol.”_ ApJ 852, 97 (2018)
6. Dünner et al. _“The Atacama Cosmology Telescope: Data Characterization and Mapmaking.”_ ApJS 209, 17 (2013)
7. Morris et al. _“Modeling Bulk Atmospheric Motion for ACT.”_ Phys. Rev. D 105, 042004 (2022)
8. Morris et al. _“Quantifying Atmospheric Emission above Cerro Toco.”_ (arXiv:2410.13064, 2024)
9. Xu et al. _“CLASS: The Cosmology Large Angular Scale Surveyor.”_ SPIE Proc. 9153 (2014)
10. Harrington et al. _“The Cosmology Large Angular Scale Surveyor (CLASS) Instrument.”_ J. Astron. Instrum. 08, 1940004 (2019)
